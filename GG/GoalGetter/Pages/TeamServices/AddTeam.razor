@inject IViewPeopleIfNotInTeamUseCase viewPeopleIfNotInTeamUseCase
<<<<<<< HEAD
@inject IAddTeamUseCase addTeamUseCase
=======
@inject ISnackbar Snackbar
>>>>>>> 0ee8f39a992afeef4ad33834d55523db3520e928

<MudCard>
	<MudSelect Label="Persons" MultiSelection="true" @bind-SelectedValues="@options">
		@if(people != null)
		{
			foreach (Person person in people)
			{
				<MudSelectItem T="Person" Value="@person">@person.Firstname</MudSelectItem>
			}
		}

	</MudSelect>
	<MudCardActions>
		<MudButton ButtonType="ButtonType.Submit" class="btn btn-primary" @onclick="Save">Save</MudButton>
		<MudButton ButtonType="ButtonType.Button" class="btn btn-primary" @onclick="Cancel">Cancel</MudButton>
	</MudCardActions>
</MudCard>




@code {
	[CascadingParameter] MudDialogInstance MudDialog { get; set; }

	void Cancel() => MudDialog.Cancel();

	[Parameter]
	public int ProId { get; set; }

	private IEnumerable<Person> people = new List<Person>();

	private IEnumerable<Person> options { get; set; } = new List<Person>();

	protected override async Task OnInitializedAsync()
	{
		StatusReport<IEnumerable<Person>> status = viewPeopleIfNotInTeamUseCase.ExecuteAsync(ProId).Result;
		if (status.Value != null)
			people = status.Value;
		else
			Snackbar.Add(status.Reason, status.severity);
	}

	private void Save()
	{
		foreach (Person p in options)
		{
			
			addTeamUseCase.ExecuteAsync(new Teammember{person = p, Role= Teamrolle.Worker}, ProId);
			
		}
	}
}
